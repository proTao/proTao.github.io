---
layout: post
date: 2018-05-09
title: 锋利的Bash(2)：字符串
category: 程序员的玩具
tags:
- tools
- linux
- shell
description:
---

## 字符串

首先，双引号里可以有变量，单引号则原样输出；双引号里可以出现转义字符，单引号则原样输出。

涉及到字符串或者说文本的处理是我认为bash中最复杂的地方。仅仅是通过${str}的处理就可以完成绝大多数的任务，这个部分也只介绍这种相关方法。

- 基本操作

```bash
a=asd123qwe456asd123qwe456
# 切片
# 下标从0开始，支持负数索引，-1表示最后一个字符
echo ${a:1} # sd123qwe456asd123qwe456
echo ${a:1:3} # sd1
echo ${a:0-6:3} # 从-6开始往右数3个：qwe，注意0是必须的
echo ${var:(-6):3} # 或者使用括号
# 删除
# #/##/%/%%分别表示在串头、串尾删除最短、最长子串
# 星号匹配任意字符、支持正则
echo ${a#asd[0-9]}
echo ${a##*asd}
echo ${a%%456*}
#替换
echo ${a/#asd/ASD} # 替换前缀
echo ${a/%456/123} # 替换后缀
echo ${a/asd/ASD} # 替换第一个
echo ${a//asd/ASD} # 全部替换
```

- expr

可以使用`info expr`查看文档。支持字符串操作和数值计算。

```bash
expr index 12345 234 # 子串位置，下标从1开始
expr match 12345asd [0-9]* # 从头匹配最大长度
expr length 12345 # 计算长度
expr asd123qwe456 : asd[0-9]* # 6:从头匹配的正则长度
expr asd123qwe456 : '\(asd[0-9]*\)' # 从头匹配到的字串，要加上引号并把想输出的分组用\(\)括起来，为啥加引号不知道。
expr substr abcde 2 3 # bcd，下标从1开始
expr index + length g # 加号对关键字进行转义
```

---

## 参考

1. [shell字符串操作详解](https://www.cnblogs.com/gaochsh/p/6901809.html)
2. [Shell脚本8种字符串截取方法总结](http://www.jb51.net/article/56563.html)
3. [shell中的${}，##和%%的使用](https://blog.csdn.net/shmilyringpull/article/details/7631106)
